# Security Capsule Manifest - Kari AI Production Standard
id: "capsule.security"
name: "Security Capsule"
version: "1.0.0"
description: |
  Zero-trust security capsule for RBAC, authentication, key management, and compliance operations.
  Enforces cryptographic validation and comprehensive audit logging for all security operations.

# Security: Required roles for execution (zero-trust enforcement)
required_roles:
  - "system.admin"
  - "capsule.security"

# Security: Allowed tool interfaces (whitelist-only)
allowed_tools:
  - "llm.generate_text"
  - "monitor.metrics"
  - "neuro_vault.query"
  - "auth.validate"
  - "rbac.check_permission"

# Security: Isolation and sandboxing policies
security_policy:
  allow_network_access: false
  allow_file_system_access: false
  allow_system_calls: false
  require_hardware_isolation: true
  max_execution_time: 30  # seconds

# Capabilities: Security operations (for documentation)
capabilities:
  - rbac_management
  - key_rotation
  - auth_validation
  - compliance_check
  - security_audit
  - threat_detection

# Observability: Audit and monitoring
auditable: true
sandboxed: true
prometheus_enabled: true

# Execution: LLM configuration
prompt_type: jinja2
max_tokens: 512
temperature: 0.3  # Lower temperature for security decisions

# Metadata
author: "Zeus - Chief Architect"
created: "2025-11-08"
updated: "2025-11-08"
