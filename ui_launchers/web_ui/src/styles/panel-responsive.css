/**
 * Responsive Panel Behavior CSS
 * 
 * CSS utilities for mobile-first responsive design, touch-optimized interactions,
 * and collapsible panel behavior on small screens.
 * 
 * Based on requirements: 2.4, 8.1, 8.3
 */

/* ============================================================================
   MOBILE-FIRST RESPONSIVE DESIGN
   ============================================================================ */

/* Base mobile styles */
.panel-responsive {
  /* Mobile-first approach */
  width: 100vw;
  max-width: 100vw;
  /* Use both vh and dvh for better browser support */
  height: 100vh;
  height: 100dvh;
  /* Ensure minimum height for content */
  min-height: 100vh;
  min-height: 100dvh;
  
  /* Touch optimization */
  touch-action: pan-y;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

/* Tablet styles */
@media (min-width: 640px) {
  .panel-responsive {
    width: 85vw;
    max-width: 85vw;
  }
}

/* Desktop styles */
@media (min-width: 768px) {
  .panel-responsive {
    width: auto;
    max-width: 75vw;
    height: auto;
    position: relative;
    
    /* Reset touch optimization for desktop */
    touch-action: auto;
    -webkit-user-select: auto;
    user-select: auto;
  }
}

@media (min-width: 1024px) {
  .panel-responsive {
    max-width: 65vw;
  }
}

@media (min-width: 1280px) {
  .panel-responsive {
    max-width: 60vw;
  }
}

/* ============================================================================
   TOUCH-OPTIMIZED INTERACTIONS
   ============================================================================ */

/* Touch target sizing (minimum 44px for iOS guidelines) */
.panel-touch-target {
  min-height: 44px;
  min-width: 44px;
  
  /* Enhanced touch feedback */
  transition: transform 0.1s ease-out, background-color 0.15s ease-out;
}

.panel-touch-target:active {
  transform: scale(0.95);
}

/* Desktop override */
@media (min-width: 768px) {
  .panel-touch-target {
    min-height: 32px;
    min-width: 32px;
  }
  
  .panel-touch-target:active {
    transform: none;
  }
  
  .panel-touch-target:hover {
    transform: translateY(-1px);
  }
}

/* Touch-friendly scrolling */
.panel-touch-scroll {
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
  overscroll-behavior: contain;
}

/* Touch gesture support */
.panel-touch-gestures {
  touch-action: pan-y pinch-zoom;
}

/* Swipe gesture indicators */
.panel-swipe-indicator {
  position: relative;
}

.panel-swipe-indicator::before {
  content: '';
  position: absolute;
  top: 8px;
  left: 50%;
  transform: translateX(-50%);
  width: 32px;
  height: 4px;
  background: var(--color-neutral-300);
  border-radius: var(--radius-full);
  opacity: 0.6;
}

@media (min-width: 768px) {
  .panel-swipe-indicator::before {
    display: none;
  }
}

/* ============================================================================
   COLLAPSIBLE PANEL BEHAVIOR
   ============================================================================ */

/* Collapsible panel states */
.panel-collapsible {
  transition: transform var(--duration-normal) var(--ease-out);
}

.panel-collapsible[data-state="closed"] {
  transform: translateX(100%);
}

.panel-collapsible[data-state="open"] {
  transform: translateX(0);
}

/* Backdrop for mobile overlay */
.panel-backdrop {
  position: fixed;
  inset: 0;
  background: rgb(0 0 0 / 0.5);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  z-index: 40;
  
  /* Animation */
  opacity: 0;
  transition: opacity var(--duration-normal) var(--ease-out);
}

.panel-backdrop[data-state="open"] {
  opacity: 1;
}

.panel-backdrop[data-state="closed"] {
  opacity: 0;
  pointer-events: none;
}

/* Hide backdrop on desktop */
@media (min-width: 768px) {
  .panel-backdrop {
    display: none;
  }
}

/* ============================================================================
   RESPONSIVE BREAKPOINT UTILITIES
   ============================================================================ */

/* Extra small screens (phones) */
@media (max-width: 479px) {
  .panel-xs-full {
    width: 100vw;
    max-width: 100vw;
  }
  
  .panel-xs-padding {
    padding: var(--space-sm);
  }
  
  .panel-xs-text-sm {
    font-size: var(--text-sm);
  }
}

/* Small screens (large phones, small tablets) */
@media (min-width: 480px) and (max-width: 639px) {
  .panel-sm-constrained {
    width: 90vw;
    max-width: 90vw;
  }
  
  .panel-sm-padding {
    padding: var(--space-md);
  }
}

/* Medium screens (tablets) */
@media (min-width: 640px) and (max-width: 767px) {
  .panel-md-constrained {
    width: 85vw;
    max-width: 85vw;
  }
  
  .panel-md-padding {
    padding: var(--space-md) var(--space-lg);
  }
}

/* Large screens (desktop) */
@media (min-width: 768px) {
  .panel-lg-auto {
    width: auto;
    height: auto;
    position: relative;
  }
  
  .panel-lg-padding {
    padding: var(--space-lg);
  }
}

/* ============================================================================
   DEVICE-SPECIFIC OPTIMIZATIONS
   ============================================================================ */

/* iOS Safari optimizations */
@supports (-webkit-touch-callout: none) {
  .panel-ios-optimized {
    /* Safe area support */
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
    
    /* Prevent zoom on input focus */
    font-size: 16px;
  }
  
  .panel-ios-scroll {
    -webkit-overflow-scrolling: touch;
    overflow-scrolling: touch;
  }
}

/* Android optimizations */
@media screen and (max-width: 767px) {
  .panel-android-optimized {
    /* Prevent viewport scaling */
    touch-action: pan-y;
    
    /* Optimize rendering */
    will-change: transform;
    transform: translateZ(0);
  }
}

/* ============================================================================
   ORIENTATION SUPPORT
   ============================================================================ */

/* Portrait orientation */
@media (orientation: portrait) {
  .panel-portrait {
    width: 100vw;
    max-width: 100vw;
  }
  
  .panel-portrait-content {
    max-height: calc(100vh - 120px); /* Account for header/footer */
    max-height: calc(100dvh - 120px);
  }
}

/* Landscape orientation on mobile */
@media (orientation: landscape) and (max-height: 600px) {
  .panel-landscape {
    width: 60vw;
    max-width: 60vw;
  }
  
  .panel-landscape-content {
    max-height: calc(100vh - 80px);
    max-height: calc(100dvh - 80px);
  }
  
  .panel-landscape-compact {
    padding: var(--space-sm);
  }
}

/* ============================================================================
   ACCESSIBILITY ENHANCEMENTS
   ============================================================================ */

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  .panel-collapsible,
  .panel-backdrop,
  .panel-touch-target {
    transition: none;
  }
  
  .panel-touch-target:active {
    transform: none;
  }
}

/* High contrast mode */
@media (prefers-contrast: high) {
  .panel-backdrop {
    background: rgb(0 0 0 / 0.8);
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
  }
  
  .panel-swipe-indicator::before {
    background: var(--color-neutral-600);
    opacity: 1;
  }
}

/* Focus management for mobile */
@media (max-width: 767px) {
  .panel-mobile-focus:focus-visible {
    outline: 3px solid var(--color-primary-500);
    outline-offset: 2px;
  }
}

/* ============================================================================
   PERFORMANCE OPTIMIZATIONS
   ============================================================================ */

/* GPU acceleration for smooth animations */
.panel-gpu-accelerated {
  transform: translateZ(0);
  will-change: transform;
  backface-visibility: hidden;
}

/* Contain layout for better performance */
.panel-performance-optimized {
  contain: layout style paint;
}

/* Optimize repaints during scrolling */
.panel-scroll-optimized {
  contain: layout;
  will-change: scroll-position;
}

/* ============================================================================
   VIEWPORT HEIGHT UTILITIES
   ============================================================================ */

/* Proper viewport height handling for panels */
.panel-viewport-height {
  /* Use both vh and dvh for better browser support */
  height: 100vh;
  height: 100dvh;
  min-height: 100vh;
  min-height: 100dvh;
  /* Ensure content fits within viewport */
  max-height: 100vh;
  max-height: 100dvh;
}

/* Desktop override for relative positioning */
@media (min-width: 768px) {
  .panel-viewport-height-desktop-auto {
    height: auto;
    min-height: auto;
    max-height: none;
  }
}

/* Safe area support for mobile devices */
@supports (height: 100dvh) {
  .panel-viewport-height {
    height: 100dvh;
    min-height: 100dvh;
    max-height: 100dvh;
  }
}

/* iOS Safari specific fixes */
@supports (-webkit-touch-callout: none) {
  .panel-viewport-height {
    /* Account for iOS Safari's dynamic viewport */
    height: -webkit-fill-available;
    min-height: -webkit-fill-available;
  }
}

/* ============================================================================
   UTILITY CLASSES
   ============================================================================ */

/* Hide on mobile */
.panel-hide-mobile {
  display: none;
}

@media (min-width: 768px) {
  .panel-hide-mobile {
    display: block;
  }
}

/* Show only on mobile */
.panel-show-mobile {
  display: block;
}

@media (min-width: 768px) {
  .panel-show-mobile {
    display: none;
  }
}

/* Responsive text sizing */
.panel-text-responsive {
  font-size: clamp(0.875rem, 2vw, 1rem);
}

/* Responsive spacing */
.panel-spacing-responsive {
  padding: clamp(var(--space-sm), 3vw, var(--space-lg));
}

/* Responsive border radius */
.panel-radius-responsive {
  border-radius: 0;
}

@media (min-width: 768px) {
  .panel-radius-responsive {
    border-radius: var(--radius-lg);
  }
}