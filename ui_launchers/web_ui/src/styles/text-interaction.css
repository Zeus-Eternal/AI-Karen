/**
 * Text Interaction and Selection Utilities
 * 
 * Ensures proper text selection, copying, highlighting, and traversal
 * across all UI components and states.
 */

/* ============================================================================ */
/* TEXT SELECTION FOUNDATION */
/* ============================================================================ */

/* Ensure text selection is enabled globally */
*,
*::before,
*::after {
  /* Enable text selection by default */
  user-select: auto;
  -webkit-user-select: auto;
  -moz-user-select: auto;
  -ms-user-select: auto;
  
  /* Enable context menu (right-click) */
  -webkit-touch-callout: default;
  -webkit-user-drag: auto;
}

/* Enhanced selection styling */
::selection {
  background: hsl(var(--primary) / 0.25);
  color: hsl(var(--primary-foreground));
  text-shadow: none;
}

::-moz-selection {
  background: hsl(var(--primary) / 0.25);
  color: hsl(var(--primary-foreground));
  text-shadow: none;
}

/* ============================================================================ */
/* INTERACTIVE ELEMENT OVERRIDES */
/* ============================================================================ */

/* Buttons should allow text selection for accessibility */
button,
[role="button"],
[type="button"],
[type="submit"],
[type="reset"] {
  user-select: auto;
  -webkit-user-select: auto;
  -moz-user-select: auto;
  -ms-user-select: auto;
}

/* Links should allow text selection */
a,
[role="link"] {
  user-select: auto;
  -webkit-user-select: auto;
  -moz-user-select: auto;
  -ms-user-select: auto;
}

/* Form elements should maintain their default selection behavior */
input,
textarea,
select,
[contenteditable] {
  user-select: auto;
  -webkit-user-select: auto;
  -moz-user-select: auto;
  -ms-user-select: auto;
}

/* ============================================================================ */
/* COMPONENT-SPECIFIC OVERRIDES */
/* ============================================================================ */

/* Ensure cards and panels allow text selection */
.modern-card,
.dashboard-card,
.chat-panel,
.glass,
.glass-strong {
  user-select: auto;
  -webkit-user-select: auto;
  -moz-user-select: auto;
  -ms-user-select: auto;
}

/* Navigation elements should allow text selection */
nav,
[role="navigation"],
.sidebar,
[data-sidebar] {
  user-select: auto;
  -webkit-user-select: auto;
  -moz-user-select: auto;
  -ms-user-select: auto;
}

/* Headers and content areas */
header,
main,
section,
article,
aside,
footer {
  user-select: auto;
  -webkit-user-select: auto;
  -moz-user-select: auto;
  -ms-user-select: auto;
}

/* ============================================================================ */
/* UTILITY CLASSES */
/* ============================================================================ */

/* Force text selection enabled */
.text-selectable {
  user-select: auto !important;
  -webkit-user-select: auto !important;
  -moz-user-select: auto !important;
  -ms-user-select: auto !important;
  -webkit-touch-callout: default !important;
}

/* Disable text selection when needed (use sparingly) */
.text-unselectable {
  user-select: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  -webkit-touch-callout: none !important;
}

/* Allow text selection in specific contexts */
.text-selectable-all {
  user-select: all !important;
  -webkit-user-select: all !important;
  -moz-user-select: all !important;
  -ms-user-select: all !important;
}

/* ============================================================================ */
/* KEYBOARD NAVIGATION SUPPORT */
/* ============================================================================ */

/* Ensure focusable elements are properly accessible */
[tabindex]:focus-visible,
button:focus-visible,
a:focus-visible,
input:focus-visible,
textarea:focus-visible,
select:focus-visible {
  outline: var(--focus-ring-width, 2px) solid hsl(var(--ring));
  outline-offset: var(--focus-ring-offset, 2px);
  border-radius: var(--radius-sm);
}

/* ============================================================================ */
/* COPY/PASTE SUPPORT */
/* ============================================================================ */

/* Ensure clipboard operations work properly */
.copyable {
  user-select: all;
  -webkit-user-select: all;
  -moz-user-select: all;
  -ms-user-select: all;
  cursor: text;
}

.copyable:hover {
  background: hsl(var(--muted) / 0.5);
  border-radius: var(--radius-sm);
  transition: background-color var(--duration-fast) var(--ease-standard);
}

/* Code blocks and pre-formatted text */
pre,
code,
.code-block {
  user-select: all;
  -webkit-user-select: all;
  -moz-user-select: all;
  -ms-user-select: all;
  cursor: text;
}

/* ============================================================================ */
/* MOBILE AND TOUCH SUPPORT */
/* ============================================================================ */

/* Ensure touch devices support text selection */
@media (pointer: coarse) {
  * {
    -webkit-touch-callout: default;
    -webkit-user-select: auto;
    user-select: auto;
  }
  
  /* Long press context menu support */
  .long-press-menu {
    -webkit-touch-callout: default;
    -webkit-user-select: auto;
    user-select: auto;
  }
}

/* ============================================================================ */
/* ACCESSIBILITY ENHANCEMENTS */
/* ============================================================================ */

/* Screen reader support */
.sr-only {
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

/* Skip links should be selectable when focused */
.skip-link:focus {
  user-select: auto;
  -webkit-user-select: auto;
  -moz-user-select: auto;
  -ms-user-select: auto;
}

/* ============================================================================ */
/* DRAG AND DROP SUPPORT */
/* ============================================================================ */

/* Elements that should be draggable */
.draggable {
  -webkit-user-drag: element;
  user-select: none; /* Prevent text selection during drag */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

/* Drop zones should allow text selection */
.drop-zone {
  user-select: auto;
  -webkit-user-select: auto;
  -moz-user-select: auto;
  -ms-user-select: auto;
}

/* ============================================================================ */
/* BROWSER-SPECIFIC FIXES */
/* ============================================================================ */

/* Safari-specific fixes */
@supports (-webkit-appearance: none) {
  * {
    -webkit-user-select: auto;
    -webkit-touch-callout: default;
  }
  
  /* Fix for Safari's aggressive text selection prevention */
  button,
  [role="button"] {
    -webkit-user-select: auto !important;
  }
}

/* Firefox-specific fixes */
@-moz-document url-prefix() {
  * {
    -moz-user-select: auto;
  }
}

/* ============================================================================ */
/* PERFORMANCE OPTIMIZATIONS */
/* ============================================================================ */

/* Optimize selection rendering */
::selection {
  text-shadow: none;
  background-clip: padding-box;
}

::-moz-selection {
  text-shadow: none;
  background-clip: padding-box;
}

/* ============================================================================ */
/* DEBUGGING UTILITIES */
/* ============================================================================ */

/* Debug class to highlight selectable areas */
.debug-selectable {
  outline: 1px dashed hsl(var(--warning-500) / 0.5) !important;
  outline-offset: 2px !important;
}

.debug-selectable::before {
  content: "SELECTABLE";
  position: absolute;
  top: -20px;
  left: 0;
  font-size: 10px;
  color: hsl(var(--warning-500));
  background: hsl(var(--warning-50));
  padding: 2px 4px;
  border-radius: 2px;
  z-index: 9999;
}