# Production Authentication Configuration
# This file contains all the necessary environment variables for production database authentication

# ============================================================================
# Database Configuration (PostgreSQL)
# ============================================================================
# Primary database connection (PostgreSQL with async driver)
POSTGRES_URL=postgresql+asyncpg://karen_user:karen_secure_pass_change_me@localhost:5432/ai_karen
AUTH_DATABASE_URL=postgresql+asyncpg://karen_user:karen_secure_pass_change_me@localhost:5432/ai_karen

# Database connection pool settings
AUTH_DB_POOL_SIZE=20
AUTH_DB_POOL_MAX_OVERFLOW=30
AUTH_DB_CONNECTION_TIMEOUT=30
AUTH_DB_QUERY_TIMEOUT=30
AUTH_DB_ENABLE_QUERY_LOGGING=false

# ============================================================================
# Redis Configuration (Session Management)
# ============================================================================
# Redis connection for session storage
REDIS_URL=redis://localhost:6379/0
AUTH_SESSION_REDIS_URL=redis://localhost:6379/0

# Session storage configuration
AUTH_SESSION_STORAGE_TYPE=redis  # Options: database, redis, memory
AUTH_SESSION_TIMEOUT_HOURS=24
AUTH_MAX_SESSIONS_PER_USER=5

# Session cookie configuration
AUTH_SESSION_COOKIE_NAME=auth_session
AUTH_SESSION_COOKIE_SECURE=true
AUTH_SESSION_COOKIE_HTTPONLY=true
AUTH_SESSION_COOKIE_SAMESITE=lax

# ============================================================================
# JWT Token Configuration
# ============================================================================
# IMPORTANT: Change this secret key in production!
AUTH_SECRET_KEY=your-super-secret-jwt-key-change-in-production-minimum-32-chars
AUTH_JWT_ALGORITHM=HS256

# Token expiration settings
AUTH_ACCESS_TOKEN_EXPIRE_MINUTES=30
AUTH_REFRESH_TOKEN_EXPIRE_DAYS=7
AUTH_PASSWORD_RESET_TOKEN_EXPIRE_HOURS=1
AUTH_EMAIL_VERIFICATION_TOKEN_EXPIRE_HOURS=24

# ============================================================================
# Password Security Configuration
# ============================================================================
# Password hashing settings (bcrypt)
AUTH_PASSWORD_HASH_ROUNDS=12
AUTH_MIN_PASSWORD_LENGTH=8
AUTH_REQUIRE_PASSWORD_COMPLEXITY=true

# Account security settings
AUTH_MAX_FAILED_ATTEMPTS=5
AUTH_LOCKOUT_DURATION_MINUTES=15

# ============================================================================
# Rate Limiting Configuration
# ============================================================================
# Rate limiting settings
AUTH_ENABLE_RATE_LIMITING=true
AUTH_RATE_LIMIT_WINDOW_MINUTES=15
AUTH_RATE_LIMIT_MAX_REQUESTS=10
AUTH_RATE_LIMIT_STORAGE=redis  # Options: memory, redis
AUTH_RATE_LIMIT_REDIS_URL=redis://localhost:6379/1

# ============================================================================
# Security Features Configuration
# ============================================================================
# Session validation settings
AUTH_ENABLE_SESSION_VALIDATION=true
AUTH_VALIDATE_IP_ADDRESS=false  # Set to true for stricter security
AUTH_VALIDATE_USER_AGENT=false  # Set to true for stricter security
AUTH_ENABLE_DEVICE_FINGERPRINTING=true

# Audit logging settings
AUTH_ENABLE_AUDIT_LOGGING=true
AUTH_LOG_SUCCESSFUL_LOGINS=true
AUTH_LOG_FAILED_LOGINS=true
AUTH_LOG_SECURITY_EVENTS=true

# ============================================================================
# Feature Flags Configuration
# ============================================================================
# Enable/disable authentication features
AUTH_ENABLE_SECURITY_FEATURES=true
AUTH_ENABLE_INTELLIGENT_AUTH=true
AUTH_ENABLE_MONITORING=true

# ============================================================================
# Monitoring and Observability
# ============================================================================
# Monitoring settings
AUTH_ENABLE_MONITORING=true
AUTH_METRICS_ENABLED=true
AUTH_HEALTH_CHECK_ENABLED=true

# Performance settings
AUTH_ENABLE_CACHING=true
AUTH_CACHE_TTL_SECONDS=300
AUTH_BATCH_SIZE=100

# ============================================================================
# Production Environment Settings
# ============================================================================
# Environment identification
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO
LOG_FORMAT=json

# Application security
SECRET_KEY=your-application-secret-key-change-in-production

# ============================================================================
# Chat Memory Configuration (Production)
# ============================================================================
# Chat memory settings for production
CHAT_MEMORY_SHORT_TERM_DAYS=7
CHAT_MEMORY_TAIL_TURNS=5
CHAT_MEMORY_LONG_TERM_DAYS=90
CHAT_MEMORY_SUMMARIZE_THRESHOLD_TOKENS=4000
CHAT_MEMORY_MAX_SUMMARY_LENGTH=500
CHAT_MEMORY_BATCH_SIZE=20
CHAT_MEMORY_CACHE_TTL_SECONDS=600

# ============================================================================
# Optional: Vector Database Configuration
# ============================================================================
# Uncomment and configure if using vector database for advanced features
# MILVUS_HOST=localhost
# MILVUS_PORT=19530
# VECTOR_INDEX_NAME=karen_auth_embeddings

# ============================================================================
# Optional: External Services Configuration
# ============================================================================
# Uncomment and configure if using external services
# ELASTICSEARCH_HOST=localhost
# ELASTICSEARCH_PORT=9200
# ELASTICSEARCH_USER=elastic
# ELASTICSEARCH_PASSWORD=elastic_secure_pass_change_me

# ============================================================================
# Security Recommendations
# ============================================================================
# 1. Change all default passwords and secret keys
# 2. Use strong, unique passwords for database connections
# 3. Enable SSL/TLS for all database and Redis connections in production
# 4. Configure firewall rules to restrict database and Redis access
# 5. Regularly rotate JWT secret keys
# 6. Monitor authentication logs for suspicious activity
# 7. Set up automated backups for the authentication database
# 8. Configure proper SSL certificates for HTTPS
# 9. Use environment-specific configuration files
# 10. Regularly update dependencies and security patches