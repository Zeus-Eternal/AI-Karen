# AI Karen - Production Environment Configuration
# This file contains production-ready environment variables
# Copy this to .env and customize for your production deployment

# =============================================================================
# CORE SERVER SETTINGS
# =============================================================================

# Backend URL - Update for your production domain
KAREN_BACKEND_URL=https://api.your-domain.com
NEXT_PUBLIC_KAREN_BACKEND_URL=https://api.your-domain.com

# System identification
SYSTEM_NAME=AI Karen Production System
NEXT_PUBLIC_BASE_URL=https://your-domain.com

# Environment
NODE_ENV=production
ENVIRONMENT=production

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Authentication - CRITICAL: Change these in production
AUTH_SECRET_KEY=CHANGE_ME_TO_SECURE_RANDOM_STRING_64_CHARS_MIN
JWT_SECRET_KEY=CHANGE_ME_TO_SECURE_RANDOM_STRING_64_CHARS_MIN

# Disable development features - CRITICAL for production
AUTH_DEV_MODE=false
AUTH_ALLOW_DEV_LOGIN=false

# Enable security features
AUTH_ENABLE_SECURITY_FEATURES=true
AUTH_ENABLE_RATE_LIMITING=true
AUTH_ENABLE_SESSION_VALIDATION=true
AUTH_ENABLE_INTELLIGENT_AUTH=true

# Session security - Enable for HTTPS
AUTH_SESSION_COOKIE_SECURE=true
AUTH_SESSION_COOKIE_HTTPONLY=true
AUTH_SESSION_COOKIE_SAMESITE=strict
AUTH_SESSION_TIMEOUT_HOURS=8

# Security headers
ENABLE_SECURITY_HEADERS=true
ENABLE_CONTENT_SECURITY_POLICY=true
ENABLE_HSTS=true
ENABLE_FRAME_OPTIONS=true

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Primary database - Update with your production database
AUTH_DATABASE_URL=postgresql+asyncpg://prod_user:SECURE_PASSWORD@db.your-domain.com:5432/ai_karen_prod

# Connection pooling for production
AUTH_DB_POOL_SIZE=20
AUTH_DB_POOL_MAX_OVERFLOW=40
AUTH_DB_CONNECTION_TIMEOUT=45
AUTH_DB_QUERY_TIMEOUT=30
AUTH_DB_ENABLE_QUERY_LOGGING=false

# Enhanced database configuration
DB_CONNECTION_TIMEOUT=45
DB_QUERY_TIMEOUT=30
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_POOL_RECYCLE=3600
DB_POOL_PRE_PING=true
DB_POOL_TIMEOUT=30
DB_ECHO=false

# Database health monitoring
DB_HEALTH_CHECK_INTERVAL=30
DB_MAX_CONNECTION_FAILURES=3
DB_CONNECTION_RETRY_DELAY=5

# =============================================================================
# OBJECT STORAGE (MinIO/S3)
# =============================================================================

# MinIO/S3 credentials - Update for production
MINIO_ACCESS_KEY=CHANGE_ME_PRODUCTION_ACCESS_KEY
MINIO_SECRET_KEY=CHANGE_ME_PRODUCTION_SECRET_KEY
MINIO_ROOT_USER=${MINIO_ACCESS_KEY}
MINIO_ROOT_PASSWORD=${MINIO_SECRET_KEY}

# S3 configuration for production
S3_BUCKET_NAME=ai-karen-production
S3_REGION=us-east-1
S3_ENDPOINT_URL=https://s3.amazonaws.com

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Logging levels
LOG_LEVEL=INFO
STRUCTURED_LOGGING=true
LOG_FORMAT=json
LOG_TO_FILE=true
LOG_FILE_PATH=/var/log/ai-karen/app.log
LOG_MAX_FILE_SIZE=100MB
LOG_BACKUP_COUNT=10

# Disable debug logging in production
DEBUG=false
VERBOSE_LOGGING=false

# =============================================================================
# MONITORING AND OBSERVABILITY
# =============================================================================

# Prometheus metrics
ENABLE_METRICS=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Health checks
HEALTH_CHECK_TIMEOUT_MS=5000
HEALTH_CHECK_INTERVAL_MS=30000

# Performance monitoring
PERFORMANCE_METRICS_ENABLE=true
PERFORMANCE_METRICS_INTERVAL=60000
PERFORMANCE_AUTO_OPTIMIZE=true

# Error tracking
ENABLE_ERROR_TRACKING=true
ERROR_REPORTING_ENDPOINT=https://your-error-tracking-service.com/api

# =============================================================================
# EMAIL SERVICE CONFIGURATION
# =============================================================================

# Email service - Configure for production
EMAIL_PROVIDER=smtp
EMAIL_ENABLED=true
EMAIL_TEST_MODE=false

# SMTP Configuration (update for your email provider)
SMTP_HOST=smtp.your-email-provider.com
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER=your-email@your-domain.com
SMTP_PASSWORD=YOUR_EMAIL_PASSWORD

# Email sender configuration
EMAIL_FROM=noreply@your-domain.com
EMAIL_FROM_NAME=AI Karen System
EMAIL_REPLY_TO=support@your-domain.com

# Email queue configuration
EMAIL_MAX_RETRIES=3
EMAIL_RETRY_DELAY=5
EMAIL_BATCH_SIZE=10
EMAIL_RATE_LIMIT=60
EMAIL_PRIORITY_PROCESSING=true

# =============================================================================
# PERFORMANCE OPTIMIZATION
# =============================================================================

# HTTP Connection Pool Settings
HTTP_CONNECTION_POOL_MAX_CONNECTIONS=100
HTTP_CONNECTION_POOL_MAX_PER_HOST=20
HTTP_CONNECTION_POOL_KEEP_ALIVE_TIMEOUT=60000
HTTP_CONNECTION_POOL_MAX_IDLE_TIME=300000
HTTP_CONNECTION_POOL_ENABLE_KEEP_ALIVE=true

# Response Cache Settings
RESPONSE_CACHE_MAX_SIZE=5000
RESPONSE_CACHE_DEFAULT_TTL=300000
RESPONSE_CACHE_MAX_MEMORY_USAGE=104857600
RESPONSE_CACHE_ENABLE_COMPRESSION=true
RESPONSE_CACHE_ENABLE_PERSISTENCE=true

# Database Query Optimization
DB_QUERY_CACHE_ENABLE=true
DB_QUERY_CACHE_TTL=300000
DB_QUERY_CACHE_MAX_SIZE=5000
DB_PREPARED_STATEMENTS_ENABLE=true
DB_SLOW_QUERY_THRESHOLD=1000

# =============================================================================
# TIMEOUT CONFIGURATION
# =============================================================================

# Timeout settings (in milliseconds)
AUTH_TIMEOUT_MS=30000
CONNECTION_TIMEOUT_MS=30000
SESSION_VALIDATION_TIMEOUT_MS=15000
DATABASE_TIMEOUT_MS=30000

# Graceful shutdown
SHUTDOWN_TIMEOUT=30
ENABLE_GRACEFUL_SHUTDOWN=true

# =============================================================================
# RETRY CONFIGURATION
# =============================================================================

# Retry settings
MAX_RETRY_ATTEMPTS=3
RETRY_BASE_DELAY_MS=1000
RETRY_MAX_DELAY_MS=10000
RETRY_EXPONENTIAL_BASE=2
ENABLE_EXPONENTIAL_BACKOFF=true

# =============================================================================
# HIGH AVAILABILITY CONFIGURATION
# =============================================================================

# Fallback backend URLs (comma-separated)
KAREN_FALLBACK_BACKEND_URLS=https://api-backup.your-domain.com,https://api-backup2.your-domain.com

# Load balancer configuration
ENABLE_LOAD_BALANCING=true
LOAD_BALANCER_STRATEGY=round_robin

# =============================================================================
# API KEYS (Optional - Configure as needed)
# =============================================================================

# Cloud provider API keys
# OPENAI_API_KEY=your_openai_api_key
# GEMINI_API_KEY=your_gemini_api_key
# HUGGINGFACE_API_KEY=your_huggingface_api_key

# =============================================================================
# MODEL CONFIGURATION
# =============================================================================

# Local model directories
LLAMA_CPP_MODELS_DIR=/opt/ai-karen/models/gguf
TRANSFORMERS_MODELS_DIR=/opt/ai-karen/models/transformers

# spaCy pipelines
SPACY_PIPELINES=en_core_web_sm,en_core_web_md

# =============================================================================
# RATE LIMITING
# =============================================================================

# Rate limiting configuration
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false
RATE_LIMIT_SKIP_FAILED_REQUESTS=false

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

# CORS settings for production
CORS_ORIGIN=https://your-domain.com
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With
CORS_CREDENTIALS=true

# =============================================================================
# SSL/TLS CONFIGURATION
# =============================================================================

# SSL settings
SSL_ENABLED=true
SSL_CERT_PATH=/etc/ssl/certs/your-domain.crt
SSL_KEY_PATH=/etc/ssl/private/your-domain.key
SSL_CA_PATH=/etc/ssl/certs/ca-bundle.crt

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================

# Backup settings
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE_PATH=/var/backups/ai-karen
BACKUP_ENCRYPTION_ENABLED=true

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Feature toggles
ENABLE_ANALYTICS=true
ENABLE_TELEMETRY=false
ENABLE_EXPERIMENTAL_FEATURES=false
ENABLE_BETA_FEATURES=false

# =============================================================================
# RESOURCE LIMITS
# =============================================================================

# Memory limits
MAX_MEMORY_USAGE_MB=2048
MAX_HEAP_SIZE_MB=1536

# Request limits
MAX_REQUEST_SIZE_MB=50
MAX_UPLOAD_SIZE_MB=100

# Concurrent request limits
MAX_CONCURRENT_REQUESTS=100
MAX_CONCURRENT_CONNECTIONS=200