# Kari AI Production Deployment Configuration
# This file contains deployment-specific settings for production environments

deployment:
  environment: "production"
  version: "1.0.0"
  
  # Plugin configuration
  plugins:
    enabled:
      - "model_orchestrator"
    
    # Plugin-specific configurations
    model_orchestrator:
      enabled: true
      auto_start: true
      health_check_enabled: true
      health_check_interval: 60
      config:
        models_root: "/app/models"
        registry_path: "/app/models/llm_registry.json"
        max_concurrent_downloads: 3
        enable_metrics: true
        enable_rbac: true
        offline_mode: false
        mirror_url: null
        max_storage_gb: 100
        enable_license_tracking: true
        enable_garbage_collection: true
        enable_compatibility_checks: true
        backup_registry: true
        auto_cleanup_enabled: true
        gc_threshold_gb: 80
        pin_essential_models: true
      
      # Security settings
      security:
        rbac_config_path: "/app/config/model_orchestrator_rbac.yml"
        enable_audit_logging: true
        audit_retention_days: 365
        max_file_size_gb: 10
        allowed_model_owners: []  # Empty means all allowed
        blocked_model_owners: []
        require_license_acceptance: true
        
      # Performance settings
      performance:
        download_timeout_minutes: 30
        retry_attempts: 3
        retry_backoff_seconds: 5
        concurrent_health_checks: 5
        cache_model_info_minutes: 15
        
      # Monitoring settings
      monitoring:
        enable_prometheus_metrics: true
        enable_opentelemetry_tracing: true
        log_level: "INFO"
        metrics_port: 9090
        health_endpoint: "/api/models/health"

  # Service dependencies
  services:
    database:
      enabled: true
      connection_pool_size: 20
      
    redis:
      enabled: true
      connection_pool_size: 10
      
    prometheus:
      enabled: true
      scrape_interval: "15s"
      
    grafana:
      enabled: true
      dashboard_refresh: "30s"

  # Resource limits
  resources:
    memory_limit: "8Gi"
    cpu_limit: "4"
    storage_limit: "500Gi"
    
  # Scaling configuration
  scaling:
    min_replicas: 2
    max_replicas: 10
    target_cpu_utilization: 70
    target_memory_utilization: 80

  # Health checks
  health_checks:
    startup_probe:
      initial_delay_seconds: 30
      period_seconds: 10
      timeout_seconds: 5
      failure_threshold: 30
      
    liveness_probe:
      initial_delay_seconds: 30
      period_seconds: 30
      timeout_seconds: 10
      failure_threshold: 3
      
    readiness_probe:
      initial_delay_seconds: 5
      period_seconds: 10
      timeout_seconds: 5
      failure_threshold: 3

  # Security configuration
  security:
    enable_tls: true
    tls_cert_path: "/app/certs/tls.crt"
    tls_key_path: "/app/certs/tls.key"
    enable_rbac: true
    rbac_config_path: "/app/config/security_config.yml"
    
  # Logging configuration
  logging:
    level: "INFO"
    format: "json"
    output: "stdout"
    enable_audit_logs: true
    audit_log_path: "/app/logs/audit.log"
    
  # Backup configuration
  backup:
    enabled: true
    schedule: "0 2 * * *"  # Daily at 2 AM
    retention_days: 30
    backup_path: "/app/backups"
    include_models: false  # Models are too large for regular backups
    include_registry: true
    include_config: true
    include_logs: true